(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{125:function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return m}));var n=a(0),r=a.n(n);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=r.a.createContext({}),u=function(e){var t=r.a.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):c(c({},t),e)),a},p=function(e){var t=u(e.components);return r.a.createElement(i.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,i=l(e,["components","mdxType","originalType","parentName"]),p=u(a),d=n,m=p["".concat(s,".").concat(d)]||p[d]||b[d]||o;return a?r.a.createElement(m,c(c({ref:t},i),{},{components:a})):r.a.createElement(m,c({ref:t},i))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,s=new Array(o);s[0]=d;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:n,s[1]=c;for(var i=2;i<o;i++)s[i]=a[i];return r.a.createElement.apply(null,s)}return r.a.createElement.apply(null,a)}d.displayName="MDXCreateElement"},127:function(e,t,a){"use strict";function n(e){var t,a,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(a=n(e[t]))&&(r&&(r+=" "),r+=a);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}t.a=function(){for(var e,t,a=0,r="";a<arguments.length;)(e=arguments[a++])&&(t=n(e))&&(r&&(r+=" "),r+=t);return r}},132:function(e,t,a){"use strict";var n=a(0),r=Object(n.createContext)(void 0);t.a=r},133:function(e,t,a){"use strict";var n=a(0),r=a(132);t.a=function(){var e=Object(n.useContext)(r.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},135:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(133),s=a(127),c=a(47),l=a.n(c),i=37,u=39;t.a=function(e){var t=e.block,a=e.children,c=e.defaultValue,p=e.values,b=e.groupId,d=Object(o.a)(),m=d.tabGroupChoices,f=d.setTabGroupChoices,h=Object(n.useState)(c),g=h[0],O=h[1],y=Object(n.useState)(!1),j=y[0],v=y[1];if(null!=b){var w=m[b];null!=w&&w!==g&&p.some((function(e){return e.value===w}))&&O(w)}var k=function(e){O(e),null!=b&&f(b,e)},_=[],C=function(e){e.metaKey||e.altKey||e.ctrlKey||v(!0)},N=function(){v(!1)};return Object(n.useEffect)((function(){window.addEventListener("keydown",C),window.addEventListener("mousedown",N)}),[]),r.a.createElement("div",null,r.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(s.a)("tabs",{"tabs--block":t})},p.map((function(e){var t=e.value,a=e.label;return r.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":g===t,className:Object(s.a)("tabs__item",l.a.tabItem,{"tabs__item--active":g===t}),style:j?{}:{outline:"none"},key:t,ref:function(e){return _.push(e)},onKeyDown:function(e){!function(e,t,a){switch(a.keyCode){case u:!function(e,t){var a=e.indexOf(t)+1;e[a]?e[a].focus():e[0].focus()}(e,t);break;case i:!function(e,t){var a=e.indexOf(t)-1;e[a]?e[a].focus():e[e.length-1].focus()}(e,t)}}(_,e.target,e),C(e)},onFocus:function(){return k(t)},onClick:function(){k(t),v(!1)},onPointerDown:function(){return v(!1)}},a)}))),r.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},n.Children.toArray(a).filter((function(e){return e.props.value===g}))[0]))}},136:function(e,t,a){"use strict";var n=a(0),r=a.n(n);t.a=function(e){return r.a.createElement("div",null,e.children)}},73:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return l})),a.d(t,"metadata",(function(){return i})),a.d(t,"rightToc",(function(){return u})),a.d(t,"default",(function(){return b}));var n=a(2),r=a(6),o=(a(0),a(125)),s=a(135),c=a(136),l={id:"1_getting_started",title:"Getting Started",sidebar_label:"Getting Started"},i={unversionedId:"2_setup/1_getting_started",id:"2_setup/1_getting_started",isDocsHomePage:!1,title:"Getting Started",description:"CassKop uses the standard Cassandra image (tested up to Version 3.11), and can run on Kubernetes 1.13.3+.",source:"@site/docs/2_setup/1_getting_started.md",slug:"/2_setup/1_getting_started",permalink:"/casskop/docs/2_setup/1_getting_started",editUrl:"https://github.com/Orange-OpenSource/casskop/edit/master/website/docs/2_setup/1_getting_started.md",version:"current",sidebar_label:"Getting Started",sidebar:"docs",previous:{title:"Roadmap",permalink:"/casskop/docs/1_concepts/4_roadmap"},next:{title:"Install Plugin",permalink:"/casskop/docs/2_setup/2_install_plugin"}},u=[{value:"CassKop deployment",id:"casskop-deployment",children:[{value:"Kubernetes preparation",id:"kubernetes-preparation",children:[]},{value:"Installing CassKop with Helm",id:"installing-casskop-with-helm",children:[]},{value:"Deploy a Cassandra cluster",id:"deploy-a-cassandra-cluster",children:[]},{value:"Monitoring",id:"monitoring",children:[]}]}],p={rightToc:u};function b(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},p,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"CassKop uses the standard Cassandra image (tested up to Version 3.11), and can run on Kubernetes 1.13.3+."),Object(o.b)("p",null,"As a pre-requisite it needs :"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://kubernetes.io/docs/tasks/tools/install-kubectl/"}),"kubectl")," version v1.13.3+."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://helm.sh/"}),"Helm")," version v2.12.2+."),Object(o.b)("li",{parentName:"ul"},"Access to a Kubernetes v1.13.3+ cluster."),Object(o.b)("li",{parentName:"ul"},"Cassandra needs fast local storage (we have tested with local storage provisioner, GKE ssd storage, and Rancher local-path-provisioner). Fast remote storage should work but is not tested yet.")),Object(o.b)("h2",{id:"casskop-deployment"},"CassKop deployment"),Object(o.b)("h3",{id:"kubernetes-preparation"},"Kubernetes preparation"),Object(o.b)("p",null,"First, we need to create a ",Object(o.b)("inlineCode",{parentName:"p"},"namespace")," in order to host our operator & cluster (here we call it cassandra)"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"kubectl create namespace cassandra\n")),Object(o.b)("h3",{id:"installing-casskop-with-helm"},"Installing CassKop with Helm"),Object(o.b)("p",null,"You can (should) deploy CassKop using this ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Orange-Opensource/casskop/tree/master/helm"}),"Helm chart"),":"),Object(o.b)("p",null,"First we add the repo:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"helm repo add orange-incubator https://orange-kubernetes-charts-incubator.storage.googleapis.com/\n")),Object(o.b)("p",null,"Then the chart itself depending on your installed version of Helm:"),Object(o.b)(s.a,{defaultValue:"helm3",values:[{label:"helm 3",value:"helm3"},{label:"helm previous",value:"helm"}],mdxType:"Tabs"},Object(o.b)(c.a,{value:"helm3",mdxType:"TabItem"},Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"# You have to create the namespace before executing following commands\nkubectl apply -f https://raw.githubusercontent.com/Orange-OpenSource/casskop/master/deploy/crds/db.orange.com_cassandraclusters_crd.yaml \nkubectl apply -f https://raw.githubusercontent.com/Orange-OpenSource/casskop/master/deploy/crds/db.orange.com_cassandrabackups_crd.yaml \nkubectl apply -f https://raw.githubusercontent.com/Orange-OpenSource/casskop/master/deploy/crds/db.orange.com_cassandrarestores_crd.yaml\n\nhelm install casskop --namespace=cassandra orange-incubator/cassandra-operator\n"))),Object(o.b)(c.a,{value:"helm",mdxType:"TabItem"},Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"# Install helm\nhelm init --history-max 200\nkubectl create serviceaccount tiller --namespace kube-system\nkubectl create -f tiller-clusterrolebinding.yaml\nhelm init --service-account tiller --upgrade\n\n# Deploy operator\nhelm install --name=casskop --namespace=cassandra orange-incubator/cassandra-operator\n")))),Object(o.b)("p",null,"You can find more information in the ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"/casskop/docs/3_configuration_deployment/1_customizable_install_with_helm"}),"Customizable install with helm"),"."),Object(o.b)("p",null,"If you have problem you can see ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"/casskop/docs/7_troubleshooting/1_operations_issues"}),"Troubleshooting")," section"),Object(o.b)("h3",{id:"deploy-a-cassandra-cluster"},"Deploy a Cassandra cluster"),Object(o.b)("h4",{id:"deploy-a-configmap"},"Deploy a ConfigMap"),Object(o.b)("p",null,"Before we can deploy our cluster, we need to create a configmap.\nThis configmap will enable us to customize Cassandra's behaviour.\nMore details on this can be found ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"/casskop/docs/3_configuration_deployment/2_cassandra_configuration#configuration-override-using-configmap"}),"here")),Object(o.b)("p",null,"But for our example we will use the simple example:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"kubectl apply -f samples/cassandra-configmap-v1.yaml\n")),Object(o.b)("h4",{id:"deploy-cassandracluster-resource"},"Deploy CassandraCluster resource"),Object(o.b)("p",null,"Once the operator is deployed inside a Kubernetes cluster, a new API will be accessible, so\nyou'll be able to create, update and delete cassandraclusters."),Object(o.b)("p",null,"In order to deploy a new cassandra cluster a ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Orange-OpenSource/casskop/blob/master/samples/cassandracluster.yaml"}),"specification")," has to be created. As an example :"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"kubectl apply -f samples/cassandracluster.yaml\n")),Object(o.b)("h3",{id:"monitoring"},"Monitoring"),Object(o.b)("p",null,"We can quickly setup monitoring for our deployed Cassandra nodes using\nPrometheus operator."),Object(o.b)("h4",{id:"deploy-prometheus"},"Deploy Prometheus"),Object(o.b)("p",null,"You can deploy the CoreOs Prometheus operator on your cluster:\nYou can find example ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Orange-OpenSource/casskop/blob/master/samples/prometheus-values.yaml"}),"helm value.yaml")," to configure the Prometheus operator:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-console"}),'kubectl create namespace monitoring\nhelm install --namespace monitoring prometheus-monitoring stable/prometheus-operator \\\n    --set prometheusOperator.createCustomResource=false \\\n    --set grafana.image.tag=7.0.1 \\\n    --set grafana.plugins="{briangann-gauge-panel,grafana-clock-panel,grafana-piechart-panel,grafana-polystat-panel,savantly-heatmap-panel,vonage-status-panel}"\n')),Object(o.b)("h4",{id:"add-servicemonitor-for-cassandra"},"Add ServiceMonitor for Cassandra"),Object(o.b)("p",null,"Then you have to create ServiceMonitor objects to monitor Cassandra nodes and CassKop. You can update this to specify\nwhich namespace to monitor (Your namespace need to be listed in the ",Object(o.b)("inlineCode",{parentName:"p"},"namespaceSelector")," section.)"),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"kubectl  apply -f monitoring/servicemonitor/")),Object(o.b)("h4",{id:"add-grafana-dashboard-for-cassandra"},"Add Grafana dashboard for Cassandra"),Object(o.b)("p",null,"You can use our dashboard that monitors both Cassandra nodes and CassKop by running:\n",Object(o.b)("inlineCode",{parentName:"p"},"kubectl  apply -f monitoring/dashboards/")))}b.isMDXComponent=!0}}]);