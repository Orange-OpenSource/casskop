<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">


<title data-react-helmet="true">Cluster Operations | Casskop</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="Casskop"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="Here is the list of Operations managed by CassKop at the **Cluster operations** level,  which apply at cluster level and which have a dedicated status in each racks"><meta data-react-helmet="true" property="og:description" content="Here is the list of Operations managed by CassKop at the **Cluster operations** level,  which apply at cluster level and which have a dedicated status in each racks"><meta data-react-helmet="true" property="og:url" content="https://orange-opensource.github.io/casskop/docs/5_operations/1_cluster_operations">

<link data-react-helmet="true" rel="shortcut icon" href="/casskop/img/casskop.ico">


<link rel="stylesheet" href="/casskop/styles.fd86d1d7.css">


<link rel="preload" href="/casskop/styles.96fb9c2f.js" as="script">

<link rel="preload" href="/casskop/runtime~main.af3b06b0.js" as="script">

<link rel="preload" href="/casskop/main.048f9187.js" as="script">

<link rel="preload" href="/casskop/1.6b5a90ca.js" as="script">

<link rel="preload" href="/casskop/2.e9ab7e35.js" as="script">

<link rel="preload" href="/casskop/3.0262e3d0.js" as="script">

<link rel="preload" href="/casskop/1be78505.def29596.js" as="script">

<link rel="preload" href="/casskop/3cde0363.a92a210d.js" as="script">

<link rel="preload" href="/casskop/17896441.59c2e6d3.js" as="script">

<link rel="preload" href="/casskop/d4be8f67.a27127cc.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}function e(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}var n=window.matchMedia("(prefers-color-scheme: dark)");n.addListener((function(n){null===e()&&t(n.matches?"dark":"")}));var a=e();null!==a?t(a):n.matches&&t("dark")}()</script>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}function e(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}var n=window.matchMedia("(prefers-color-scheme: dark)");n.addListener((function(n){null===e()&&t(n.matches?"dark":"")}));var a=e();null!==a?t(a):n.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/casskop/"><img class="navbar__logo" src="/casskop/img/casskop_alone.png" alt="Casskop Logo"><strong>Casskop</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/casskop/docs/1_concepts/1_introduction">Docs</a><a class="navbar__item navbar__link" href="/casskop/blog">Blog</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/Orange-OpenSource/casskop">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/casskop/"><img class="navbar__logo" src="/casskop/img/casskop_alone.png" alt="Casskop Logo"><strong>Casskop</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/1_concepts/1_introduction">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://github.com/Orange-OpenSource/casskop">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="sidebarLogo_3ono"><img src="/casskop/img/casskop_alone.png" alt="Casskop Logo"><strong>Casskop</strong></div><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/1_concepts/1_introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/1_concepts/2_design_principes">Design Principes</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/1_concepts/3_features">Features</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/1_concepts/4_roadmap">Roadmap</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Setup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/2_setup/1_getting_started">Getting Started</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Platform Setup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/2_setup/2_platform_setup/1_gke">Google Kubernetes Engine</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/2_setup/2_platform_setup/2_minikube">MiniKube</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Install</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/2_setup/3_install/1_customizable_install_with_helm">Customizable install with Helm</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/2_setup/3_install/2_install_plugin">Install Plugin</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tasks</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/1_operator_description">Operator Description</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Configuration Deployment</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/1_cassandra_cluster">Cassandra Cluster</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/2_cassandra_configuration">Cassandra Configuration</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/3_storage">Storage</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/4_sidecars">Sidecars</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/5_kubernets_objects">Kubernetes Objects</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/6_cpu_memory_usage">CPU and Memory Usage</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/7_cluster_topology">Cluster topology</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/8_implementation_architecture">Implementation architecture</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/9_advanced_configuration">Advanced Configuration</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/10_nodes_management">Nodes Management</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/11_cassandra_cluster_status">CassandraCluster Status</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Operations</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/casskop/docs/5_operations/1_cluster_operations">Cluster Operations</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/5_operations/2_pods_operations">Pods Operations</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Upgrade</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/5_operations/3_upgrading/1_upgrade_operator">Upgrade Operator</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/5_operations/3_upgrading/2_upgrade_bootstrap_image">Upgrade Bootstrap Image</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Uninstall</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/5_operations/4_uninstall/1_casskop">Casskop</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">MultiCasskop</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/5_operations/5_multicasskop/1_cassandra_cluster">Cassandra Cluster</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Cassandra Cluster</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/6_references/1_cassandra_cluster/1_cassandra_cluster">Cassandra cluster</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/6_references/1_cassandra_cluster/2_topology">Topology</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/6_references/1_cassandra_cluster/3_cassandra_cluster_status">Cassandra cluster Status</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">MultiCasskop</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/6_references/2_multicasskop/1_multicasskop">MultiCasskop</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/7_troubleshooting/1_operations_issues">Operations Issues</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/7_troubleshooting/2_gke_issues">GKE Issues</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Contributing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/8_contributing/1_developer_guide">Developer guide</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/8_contributing/2_release_guide">Release guide</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/8_contributing/3_reporting_bugs">Reporting bugs</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/8_contributing/4_credits">Credits</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Cluster Operations</h1></header><div class="markdown"><p>Here is the list of Operations managed by CassKop at the <strong>Cluster operations</strong> level,  which apply at cluster level and which have a dedicated status in each racks</p><p>Those operations are applied at the Cassandra cluster level, as opposite to Pod operations that are executed at pod
level and are discussed in the next section.
Cluster Operations must only be triggered by a change made on the <code>CassandraCluster</code> object.</p><p>Some updates in the <code>CassandraCluster</code> CRD object are forbidden and will be gently dismissed by CassKop:</p><ul><li><code>spec.dataCapacity</code></li><li><code>spec.dataStorage</code></li></ul><p>Some Updates in the <code>CassandraCluster</code> CRD object will trigger a rolling update of the whole cluster such as :</p><ul><li><code>spec.resources</code></li><li><code>spec.baseImage</code></li><li><code>spec.version</code></li><li><code>spec.configMap</code></li><li><code>spec.gcStdout</code></li><li><code>spec.runAsUser</code></li></ul><p>Some Updates in the <code>CassandraCluster</code> CRD object will not trigger change on the cluster but only in future behavior of
CassKop :</p><ul><li><code>spec.autoPilot</code></li><li><code>spec.autoUpdateSeedList</code></li><li><code>spec.deletePVC</code></li><li><code>spec.hardAntiAffinity</code></li><li><code>spec.rollingPartition</code></li><li><code>spec.maxPodUnavailable</code></li><li><code>noCheckStsAreEqual</code></li></ul><p>CassKop manages rolling updates for each statefulset in the cluster. Then each statefulset is making the rolling
updated of it&#x27;s pod according to the <code>partition</code> defined for each statefulset in
the <code>spec.topology.dc[].rack[].rollingPartition</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="initializing"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#initializing" title="Direct link to heading">#</a>Initializing</h3><p>The First Operation required in a Cassandra Cluster is the initialization.</p><p>In this Phase, the CassKop will create the <code>CassandraCluster.Status</code> section with an entry for each DC/Rack declared
in the <code>CassandraCluster.spec.topology</code> section.</p><p>We could also have Initializing status if we decided later to add some DC to our topology.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="with-no-topology-defined"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#with-no-topology-defined" title="Direct link to heading">#</a>With no <code>topology</code> defined</h4><p>For demo we will create this CassandraCluster without topology section</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;db.orange.com/v1alpha1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CassandraCluster&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">cluster</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> k8s.pic</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">nodesPerRacks</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">baseImage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandra</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> latest</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">rollingPartition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">dataCapacity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;3Gi&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">dataStorageClass</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;local-storage&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">hardAntiAffinity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">deletePVC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">autoPilot</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">gcStdout</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">autoUpdateSeedList</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">resources</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">requests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cpu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;2&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 2Gi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">limits</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cpu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;2&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 2Gi</span></div></code></pre></div><blockquote><p>If no <code>topology</code> has been specified, then CassKop creates the default topology and status.</p></blockquote><p>The default topology added by CassKop is :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">topology</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> dc1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">rack</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rack1</span></div></code></pre></div><p>The number of cassandra nodes <code>CassandraCluster.spec.nodesPerRacks</code> defines the number of cassandra nodes CassKop
must create in each of it&#x27;s racks. In our example, there is only one default rack, so CassKop will only create 2
nodes.</p><div class="admonition admonition-important"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>important</h5></div><div class="admonition-content"><p>with the default topology there will be no Kubernetes NodesAffinity to spread the Cassandra nodes on the
cluster. In this case, CassKop will only create one Rack and one DC for Cassandra. It is not recommended as you may
lose data in case of hardware failure</p></div></div><p>When Initialization has ended you should have a Status similar to :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">cassandraRackStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initializing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-18T15:10:51Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initializing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterActionStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">seedlist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">0.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div></code></pre></div><ul><li>The Status of the <code>dc1-rack1</code> is <code>Initializing=Done</code></li><li>The Status of the Cluster is <code>Initializing=Done</code></li><li>The phase is <code>Running</code> which means that each Rack has the desired amount of Nodes.</li></ul><p>We asked 2 <code>nodesPerRacks</code> and we have one default rack, so we ended with 2 Cassandra nodes in our cluster.</p><p>The Cassandra <code>seedlist</code> has been initialized and stored in the CassandraCluster.status.seedlist`. It has also been
configured in each of the Cassandra Pods.</p><p>We can also confirm that Cassandra knows about the DC and Rack name we have deployed :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-console codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl exec -ti cassandra-demo-dc1-rack1-0 nodetool status</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Datacenter: dc1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===============</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Status=Up/Down</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|/ State=Normal/Leaving/Joining/Moving</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--  Address        Load       Tokens       Owns (effective)  Host ID                               Rack</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.18.72.28   65.86 KiB  32           100.0%            fdc1a9e9-c5c3-4169-ae47-e6843efa096d  rack1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.18.120.12  65.86 KiB  32           100.0%            509ca725-fbf9-422f-a8e0-5e2a55474f70  rack1</span></div></code></pre></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="with-topology-defined"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#with-topology-defined" title="Direct link to heading">#</a>With <code>topology</code> defined</h4><p>In this example, I added a topology defining 2 Cassandra DC and 3 racks in total</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;db.orange.com/v1alpha1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CassandraCluster&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">cluster</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> k8s.pic</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">nodesPerRacks</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">baseImage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandra</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> latest</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">rollingPartition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">dataCapacity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;3Gi&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">dataStorageClass</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;local-storage&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">hardAntiAffinity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">deletePVC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">autoPilot</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">autoUpdateSeedList</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">resources</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">requests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cpu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;2&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 2Gi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">limits</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cpu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;2&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 2Gi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">topology</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> dc1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token key atrule">failure-domain.beta.kubernetes.io/region</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> europe</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">west1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">rack</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rack1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token key atrule">failure-domain.beta.kubernetes.io/zone</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> europe</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">west1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">b</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rack2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token key atrule">failure-domain.beta.kubernetes.io/zone</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> europe</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">west1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">c</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> dc2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">nodesPerRacks</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">numTokens</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">32</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token key atrule">failure-domain.beta.kubernetes.io/region</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> europe</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">west1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">rack</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rack1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token key atrule">failure-domain.beta.kubernetes.io/zone</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> europe</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">west1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">d</span></div></code></pre></div><p>With this topology section I also references some <strong>Kubernetes nodes labels</strong>
which will be used to spread the Cassandra
nodes on each Racks on different groups of Kubernetes servers.</p><div class="admonition admonition-note"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>note</h5></div><div class="admonition-content"><p>We can see here that we can give specific configuration for the number of pods in the dc2 (<code>nodesPerRacks: 3</code>)
We also allow to configure Cassandra pods with different num_tokens confioguration for each dc : <code>numTokens</code>.</p></div></div><p>CassKop will create a statefulset for each Rack, and start creating the
Cassandra Cluster, starting by nodes from the Rack 1.
When CassKop will end operations on Rack1, it will process the next rack and so on.</p><p>The status may be similar to :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">cassandraRackStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initializing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initializing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initializing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initializing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc2-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initializing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initializing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initializing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterActionStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initializing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">seedlist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">0.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">0.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack2.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">0.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">2.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div></code></pre></div><p>The creation of the cluster is ongoing.
We can see that, regarding the Cluster Topology, CassKop has created the SeedList.</p><div class="admonition admonition-tip"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>tip</h5></div><div class="admonition-content"><p>CassKop compute a seedlist with 3 nodes in each datacenter (if possible). The Cassandra seeds are always the
first Cassandra nodes of a statefulset (starting with index 0).</p></div></div><p>When all racks are in status done, then the <code>CassandraCluster.status.lastClusterActionStatus</code> is changed to <code>Done</code>.</p><p>We can see that internally Cassandra also knows the desired topology :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">k exec -ti cassandra-demo-dc1-rack1-0 nodetool status</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Datacenter: dc1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===============</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Status=Up/Down</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|/ State=Normal/Leaving/Joining/Moving</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--  Address        Load       Tokens       Owns (effective)  Host ID                               Rack</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.18.112.6   126.05 KiB  32           38.5%             1512da3c-f6b2-469f-95d1-2d060043777a  rack1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.18.64.10   137.08 KiB  32           32.0%             8149054f-4bc3-4093-a6ef-80910c018122  rack2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.18.88.9    154.54 KiB  32           30.2%             dbe44aa6-6763-4bc1-825a-9ea7d21690e3  rack2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.18.120.15  119.88 KiB  32           33.7%             c87e858d-66a8-4544-9d28-718a1f94955b  rack1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Datacenter: dc2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===============</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Status=Up/Down</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|/ State=Normal/Leaving/Joining/Moving</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--  Address        Load       Tokens       Owns (effective)  Host ID                               Rack</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.18.72.8    119.65 KiB  32           26.9%             8688abd3-08b6-44e0-8805-05bd3650eea6  rack1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.18.104.8   153.08 KiB  32           38.8%             62adf02d-8c55-4d95-a459-45b1c9c3aa91  rack1</span></div></code></pre></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="updateconfigmap"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#updateconfigmap" title="Direct link to heading">#</a>UpdateConfigMap</h3><p>You can find in the <a href="/casskop/docs/3_tasks/2_configuration_deployment/2_cassandra_configuration">cassandra-configuration</a> section how you can use
the <code>spec.configMap</code> parameter.</p><div class="admonition admonition-important"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>important</h5></div><div class="admonition-content"><p>Actually CassKop doesn&#x27;t monitor changes inside the ConfigMap. If you want to change a parameter in a
file in the current configMap, you must create a new configMap with the updated version, and then ask CassKop to use
the new configmap name.</p></div></div><p>If we add/change/remove the <code>CassandraCluster.spec.configMapName</code> then CassKop will start a RollingUpdate of each
CassandraNodes in each Racks, starting from the first Rack defined in the <code>topology</code>.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;db.orange.com/v1alpha1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CassandraCluster&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">cluster</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> k8s.pic</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">nodesPerRacks</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">baseImage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandra</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> latest</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">rollingPartition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">dataCapacity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;3Gi&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">dataStorageClass</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;local-storage&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">hardAntiAffinity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">deletePVC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">autoPilot</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">autoUpdateSeedList</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">configMapName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">configmap</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">v1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span></div></code></pre></div><p>First we need to create the configmap exemple: </p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f samples/cassandra-configmap-v1.yaml</span></div></code></pre></div><p>Then we apply the changes in the <code>CassandraCluster</code>.</p><p>We can see the <code>CassandraCluster.Status</code> updated by CassKop</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">cassandraRackStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateConfigMap</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T12:24:24Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Pending</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initializing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T10:33:10Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc2-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initializing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T10:34:47Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateConfigMap</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterActionStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div></code></pre></div><div class="admonition admonition-note"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>note</h5></div><div class="admonition-content"><p>CassKop won&#x27;t make a rolling update on the next rack until the status of the current rack becomes<code>Done</code>.
The Operation is processing &quot;rack per rack&quot;.</p></div></div><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">cassandraRackStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateConfigMap</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T12:26:10Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T12:24:24Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateConfigMap</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T12:27:25Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T12:26:10Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc2-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateConfigMap</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T12:27:27Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Pending</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateConfigMap</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterActionStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div></code></pre></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="updatedockerimage"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#updatedockerimage" title="Direct link to heading">#</a>UpdateDockerImage</h3><p>CassKop allows you to change the Cassandra docker image and gracefully redeploy your whole cluster. </p><p>If we change the <code>CassandraCluster.spec.baseImage</code> and or <code>CassandraCluster.spec.version</code>  CassKop will start to
perform a RollingUpdate on the whole cluster (for each racks sequentially, in order to change the version of the
Cassandra Docker Image on all nodes.</p><p>You can change the docker image used to :</p><ul><li>change the version of Cassandra</li><li>change the version of Java</li><li>Change some configuration parameters for cassandra or jvm if you don&#x27;t overwrite them with a ConfigMap</li></ul><p>The status may be similar to:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">cassandraRackStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateDockerImage</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-18T16:08:59Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Pending</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initializing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-18T16:05:51Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc2-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initializing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-18T16:07:52Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateDockerImage</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterActionStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Pending</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">seedlist</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">0.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">0.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack2.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">0.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">2.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1.cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div></code></pre></div><p>We can see that CassKop has started to Update the <code>dc1-rack1</code> and it has changed the <code>lastClusterAction</code> and
<code>lastClusterStatus</code> accordingly.</p><p>Once it has finished the first rack, then it processes the next one:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">cassandraRackStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateDockerImage</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-18T16:10:51Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-18T16:08:59Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateDockerImage</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-18T16:10:51Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Pending</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc2-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initializing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-18T16:07:52Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateDockerImage</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterActionStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div></code></pre></div><p>And when all racks are Done:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">cassandraRackStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateDockerImage</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-18T16:10:51Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-18T16:08:59Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateDockerImage</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-18T16:12:42Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-18T16:10:51Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc2-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateDockerImage</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-18T16:14:52Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-18T16:12:42Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateDockerImage</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterActionStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div></code></pre></div><p>This provides a Central view to monitor what is happening on the Cassandra Cluster.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="updateresources"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#updateresources" title="Direct link to heading">#</a>UpdateResources</h3><p>CassKop allows you to configure your Cassandra&#x27;s pods resources (memory and cpu). </p><p>If we change the <code>CassandraCluster.spec.resources</code>, then CassKop will start to make a RollingUpdate on the whole
cluster (for each racks sequentially) to change the version of the Cassandra Docker Image on all nodes.</p><div class="admonition admonition-tip"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></div>See section </h5></div><div class="admonition-content"><p><a href="/casskop/docs/3_tasks/2_configuration_deployment/6_cpu_memory_usage#resource-limits-and-requests">Resource limits and requets</a></p></div></div><p>For example, to increase Memory/CPU requests and/or limits:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">requests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cpu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;2&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 3Gi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">limits</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cpu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;2&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 3Gi</span></div></code></pre></div><p>Then CassKop should output the status: </p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">cassandraRackStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateResources</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T15:28:43Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Pending</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateResources</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T15:28:43Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ToDo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc2-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateResources</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T15:28:43Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ToDo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateResources</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterActionStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div></code></pre></div><p>We can see that it has staged the <code>UpdateResources</code> action in all racks (<code>status=ToDo</code>) and has started the action in
the first rack (<code>status=Ongoing</code>). Once <code>Done</code> it will follow with next rack, and so on.</p><p>Upon completion, the status may look like :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">cassandraRackStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateResources</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T15:30:31Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T15:28:43Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateResources</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T15:32:12Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T15:30:32Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc2-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateResources</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T15:34:07Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-21T15:32:13Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateResources</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterActionStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div></code></pre></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="scaling-the-cluster"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#scaling-the-cluster" title="Direct link to heading">#</a>Scaling the cluster</h3><p>The Scaling of the Cluster is managed through the nodesPerRacks parameters and through the number of Dcs and Racks
defined in the Topology section.</p><p>See section <a href="/casskop/docs/3_tasks/2_configuration_deployment/2_cassandra_configuration#nodesperracks">NodesPerRacks</a></p><div class="admonition admonition-note"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>note</h5></div><div class="admonition-content"><p>if the ScaleUp (or the ScaleDown) may change the SeedList and if <code>spec.autoUpdateSeedList</code> is set to <code>true</code>
then CassKop will program a new operation : <code>UpdateSeedList</code> which will trigger a rollingUpdate to apply the new
seedlist on all nodes, once the Scaling is done.</p></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="scaleup"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#scaleup" title="Direct link to heading">#</a>ScaleUp</h4><p>CassKop allows you to Scale Up your Cassandra cluster.</p><p>There is a global parameter <code>CassandraCluster.spec.nodesPerRacks</code> which specify the number of Cassandra nodes we want in
a rack.</p><p>It is possible to surcharge this for a particular DC in the <code>CassandraCluster.spec.topology.dc[&lt;idx&gt;].nodesPerRacks</code></p><p>Example:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">topology</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> dc1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">rack</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rack1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rack2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> dc2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">nodesPerRacks</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 3        &lt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"> We increase by one this value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">rack</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rack1</span></div></code></pre></div><p>In this case, we ask to ScaleUp nodes of second DC <code>dc2</code></p><p>CassKop takes into account the new target, and starts applying modifications in the cluster :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateSeedList</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Configuring</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateSeedList</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Configuring</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc2-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ScaleUp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-27T15:02:21Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Configuring</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Pending</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ScaleUp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterActionStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">...</span></div></code></pre></div><p>We can see that CassKop:</p><ul><li>Has started the <code>ScaleUp</code> action in <code>dc2-rack1</code></li><li>Has found that the SeedList must be updated, and because the autoUpdateSeedList=true it has staged
(<code>status=Configuring</code>) the UpdateSeedList operation for <code>dc1-rack1</code> and <code>dc1-rack2</code></li></ul><p>When CassKop ends the ScaleUp action in the <code>dc2-rack1</code> then it will also stage this rack with <code>UpdateSeedList=Configuring</code>.
Once all racks are in this state, CassKop will turn each Rack in status <code>UpdateSeedList=ToDo</code>, meaning that it can
start the operation. </p><p>Starting from then, CassKop will iterate on each rack one after the other and get status :</p><ul><li><code>UpdateSeedList=Ongoing</code> meaning that it is currently doing a rolling update on the Rack to update the SeedList seting
also sets the <code>startTime</code>.</li><li><code>UpdateSeedList=Done</code> meaning that the operation is done. (then, it sets the <code>endTime</code>)</li></ul><p>See evolution of status:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">cassandraRackStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateSeedList</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-27T15:05:00Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-27T15:03:13Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateSeedList</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-27T15:03:13Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Pending</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc2-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateSeedList</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ToDo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateSeedList</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterActionStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Finalizing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Pending</span></div></code></pre></div><p>Here is the final topology seen from nodetool :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ k exec -ti cassandra-demo-dc1-rack1-0 nodetool status</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Datacenter: dc1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===============</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Status=Up/Down</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|/ State=Normal/Leaving/Joining/Moving</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--  Address        Load       Tokens       Owns (effective)  Host ID                               Rack</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.18.88.6    211.95 KiB  32           27.4%             dbe44aa6-6763-4bc1-825a-9ea7d21690e3  rack2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.18.112.5   231.49 KiB  32           29.2%             1512da3c-f6b2-469f-95d1-2d060043777a  rack1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.18.64.10   188.36 KiB  32           27.6%             8149054f-4bc3-4093-a6ef-80910c018122  rack2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.18.120.14  237.62 KiB  32           29.8%             c87e858d-66a8-4544-9d28-718a1f94955b  rack1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Datacenter: dc2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===============</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Status=Up/Down</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|/ State=Normal/Leaving/Joining/Moving</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--  Address        Load       Tokens       Owns (effective)  Host ID                               Rack</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.18.72.8    228.54 KiB  32           22.0%             8688abd3-08b6-44e0-8805-05bd3650eea6  rack1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.18.104.8   212.34 KiB  32           32.2%             62adf02d-8c55-4d95-a459-45b1c9c3aa91  rack1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.18.88.9    148.34 KiB  32           31.7%             fecdfb5d-3ad4-4204-8ca5-cc7f1c4c19c4  rack1</span></div></code></pre></div><p>Note that nodetool prints IP of nodes while kubernetes works with names :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ k get pods -o wide -l app=cassandracluster</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">NAME                         READY     STATUS    RESTARTS   AGE       IP              NODE      NOMINATED NODE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra-demo-dc1-rack1-0   1/1       Running   0          14m       172.18.112.5    node006   &lt;none&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra-demo-dc1-rack1-1   1/1       Running   0          15m       172.18.120.14   node003   &lt;none&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra-demo-dc1-rack2-0   1/1       Running   0          13m       172.18.88.6     node005   &lt;none&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra-demo-dc1-rack2-1   1/1       Running   0          13m       172.18.64.10    node004   &lt;none&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra-demo-dc2-rack1-0   1/1       Running   0          10m       172.18.72.8     node008   &lt;none&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra-demo-dc2-rack1-1   1/1       Running   0          11m       172.18.104.8    node007   &lt;none&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra-demo-dc2-rack1-2   1/1       Running   0          12m       172.18.88.9     node005   &lt;none&gt;</span></div></code></pre></div><p>After the ScaleUp has finished, CassKop must execute a cassandra <code>cleanup</code> on each nodes of the Cluster.
This can be manually triggered by setting appropriate labels on each Pods.</p><p>CassKop can automate this if <code>spec.autoPilot</code> is true by setting the labels on each Pods of the cluster with a ToDo
state and then find thoses pods to sequentially execute thoses actions.</p><p>See podOperation <a href="/casskop/docs/5_operations/2_pods_operations#operationcleanup">Cleanup</a>!!</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="updatescaledown"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#updatescaledown" title="Direct link to heading">#</a>UpdateScaleDown</h3><p>For ScaleDown, CassKop must perform a clean cassandra <code>decommission</code> prior to actually scale down the cluster at
Kubernetes level.</p><p>Actually, this is done through CassKop asking the decommission through a jolokia call and waiting for it to be
performed (cassandra node status = decommissionned) before updating kubernetes statefulset (removing the pod).</p><div class="admonition admonition-important"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>important</h5></div><div class="admonition-content"><p>If we ask to scale down more than 1 node at a time, then CassKop will iterate on a single scale down
until it reaches the requested number of nodes.</p><p>Also CassKop will refuse a scaledown to 0 for a DC if there still have some data replicated to it.</p></div></div><p>To launch a ScaleDown, we simply need to decrease the value of nodesPerRacks.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">topology</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> dc1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">rack</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rack1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rack2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> dc2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">nodesPerRacks</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 2        &lt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"> Get back to 2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">rack</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rack1</span></div></code></pre></div><p>We can see in the below example that:</p><ul><li>It has started the <code>ScaleDown</code> action in <code>dc2-rack1</code></li><li>CassKop has found that the SeedList must be updated, and it has staged (<code>status=ToDo</code>) it for <code>dc1-rack1</code> and
<code>dc1-rack2</code></li></ul><p>When CassKop completes the ScaleDown in the <code>dc2-rack1</code> then it will stage it also with <code>UpdateSeedList=ToDo</code> Once all
racks are in this state, CassKop will turn each Rack in status <code>UpdateSeedList=Ongoing</code> meaning that it can start the
operation, it also set the <code>startTime</code></p><p>Then, CassKop will iterate on each rack one after the other and get status :</p><ul><li><code>UpdateSeedList=Finalizing</code> meaning that it is currently doing a rolling update on the Rack to update the SeedList</li><li><code>UpdateSeedList=Done</code> meaning that the operation is done. Then, it sets the <code>endTime</code>.</li></ul><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">cassandraRackStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateSeedList</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ToDo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateSeedList</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ToDo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc2-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ScaleDown</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-27T15:22:23Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> decommission</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">pods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-27T15:22:23Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ScaleDown</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterActionStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div></code></pre></div><p>When <code>ScaleDown=Done</code> CassKop will start the UpdateSeedList operation.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">cassandraRackStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateSeedList</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-27T15:23:54Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Finalizing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Pending</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc1-rack2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateSeedList</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-27T15:23:54Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dc2-rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandraLastAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateSeedList</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-27T15:23:54Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ongoing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Running</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">podLastOperation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">Name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> decommission</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">endTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-27T15:23:51Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">podsOK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">startTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2018-09-27T15:22:23Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Done</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterAction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> UpdateSeedList</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">lastClusterActionStatus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Finalizing</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">phase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Pending</span></div></code></pre></div><p>It shows also that <code>podLastOperation</code> <code>decommission</code> is <code>Done</code>. CassKop will then rollingUpdate all racks one by one
in order to update the Cassandra seedlist.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="updateseedlist"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#updateseedlist" title="Direct link to heading">#</a>UpdateSeedList</h3><p>The UpdateSeedList is done automatically by CassKop when the parameter
<code>CassandraCluster.spec.autoUpdateSeedList</code> is true (default).</p><p>See <a href="#updatescaleup">ScaleUp</a> and <a href="#updatescaledown">ScaleDown</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="correctcrdconfig"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#correctcrdconfig" title="Direct link to heading">#</a>CorrectCRDConfig</h3><p>The CRD <code>CassandraCluster</code> is used to define your cluster configuration. Some fields can&#x27;t be updated in a kubernetes
clusters. Some fields are taken from the CRD to configure thoses objects, and to be sure we don&#x27;t update them (to
prevent kubernetes objects in errors), we have configure CassKop to simply ignore/revert unauthorized changed to the
CRD.</p><p>Example With this CRD deployed :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">nodesPerRacks</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">baseImage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandra</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> latest</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">imagePullSecret</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> advisedev </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># To authenticate on docker registry</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">rollingPartition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">dataCapacity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> &quot;3Gi&quot;                  &lt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> can&#x27;t be changed</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">dataStorageClass</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> &quot;local</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">storage&quot;    &lt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> can&#x27;t be changed</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">hardAntiAffinity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">deletePVC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">autoPilot</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">autoUpdateSeedList</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span></div></code></pre></div><p>If we try to update the <code>dataCapacity</code> or <code>dataStorageClass</code> nothing will happen. And we could see thoses messages in
the logs of CassKop :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">time=&quot;2018-09-27T17:44:13+02:00&quot; level=warning msg=&quot;[cassandra-demo]: CassKop has refused the changed on DataCapacity from [3Gi] to NewValue[4Gi]&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">time=&quot;2018-09-27T17:44:35+02:00&quot; level=warning msg=&quot;[cassandra-demo]: CassKop has refused the changed on DataStorageClass from [local-storage] to NewValue[local-storag]&quot;</span></div></code></pre></div><p>If you performed the modification by updating your local CRD file and apply it with kubectl you must revert to the old
value.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="delete-a-dc"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#delete-a-dc" title="Direct link to heading">#</a>Delete a DC</h3><ul><li>Prior to delete a DC, you must have ScaleDown to 0 all the Racks, if not, CassKop will refuse and correct the CRD.</li><li>Prior to scaleDown to 0 CassKop will ensure that there are no more data replicated to the DC, if not, CassKop
will refuse and correct the CRD.
Because CassKop wants that we have the same amounts of pods in all racks, we decided that we would&#x27;t allow to remove
only a rack. This will be revert too.
</li></ul><div class="admonition admonition-important"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>important</h5></div><div class="admonition-content"><p>You must ScaleDown to 0 priori to Remoove a DC
You must change replication factor prior to ScaleDown  to 0 a DC</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="kubernetes-node-maintenance-operation"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#kubernetes-node-maintenance-operation" title="Direct link to heading">#</a>Kubernetes node maintenance operation</h3><p>In a normal production environment, CassKop will have spread it&#x27;s Cassandra pods on differents k8s nodes. If the team
in charge of the machines needs to make some operations on a host they can make a drain.</p><p>The Kubernetes drain command will ask the scheduler to make an eviction for all pods on the current nodes, and for many
workloads k8s will reschedule them on other machines. In the case of CassKop cassandra pods, they won&#x27;t be scheduled
on another host, because they uses local-storage and are stick to a specific host thanks to the PersistentVolumeClaim
kubernetes object.</p><p>Example: we drain the node008 for a maintenance operation.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl drainnode node008 --ignore-daemonsets --delete-local-data</span></div></code></pre></div><p>All pods will be evicted, thoses who can will be rescheduled on another hosts.
Our Cassandra pod won&#x27;t we able to be schedule elsewhere due to the PVS, and we can see this messages in the k8s events :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">0s    Warning   FailedScheduling   Pod   0/8 nodes are available: 1 node(s) were unschedulable, 2 node(s) had taints</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">that the pod didn&#x27;t tolerate, 5 node(s) had volume node affinity conflict.</span></div></code></pre></div><p>It explain that 1 node is unshedulable, this is the one we just drain. the 5 other nodes can&#x27;t be scheduled by our pod
because they have volume node affinity conflict ()our pods have an affinity on node008).</p><p>Once the team have finished their maintenance operation they can bring back the host into the kubernetes cluster. From
then, k8s will be able to reshedule back the cassandra pod into the cluster so that it can re-join the ring.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl uncordon node008</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">node/node008 uncordoned</span></div></code></pre></div><p>Immediately the pending pod is rescheduled and started on the host.
If the time of interruption was not too long there is nothing more to do, the node will join the ring and re-synchronise
with the cluster. If the time was too long, then it may be needed to schedule some PodOperations that you will find in
nexts sections of this document.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="the-poddisruptionbudget-pdb-protection"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-poddisruptionbudget-pdb-protection" title="Direct link to heading">#</a>The PodDisruptionBudget (PDB) protection</h4><p>If a k8s admin ask to drain a node, this may not been allowed by the cassandracluster regarding it&#x27;s current state and
the configuration of its PDB (usually only 1 nodes allowed to be in disruption).</p><p>Example :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl drainnode node008 --ignore-daemonsets --delete-local-data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">error when evicting pod &quot;cassandra-demo-dc2-rack1-0&quot; (will retry after 5s): Cannot evict pod as it would violate the pod&#x27;s disruption budget.</span></div></code></pre></div><p>The node008 will be flagged as SchedulingDisabled, so that it won&#x27;t take new workload. It will evict all possible pods,
but if there was an ongoing disruption on the current Cassandra cluster, it won&#x27;t be allowed to evict the cassandra pod.</p><p>Example of a PDB :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> policy/v1beta1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> PodDisruptionBudget</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">creationTimestamp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token datetime number" style="color:rgb(247, 140, 108)">2019-02-13T15:17:05Z</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">generation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandracluster</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">cassandracluster</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">cluster</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> k8s.pic</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">ownerReferences</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> db.orange.com/v1alpha1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">controller</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> CassandraCluster</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">uid</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 45fc4a22</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">2fa2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">11e9</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">8df0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">009c0296dbc4</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">resourceVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;12093573&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">selfLink</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /apis/policy/v1beta1/namespaces/cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test/poddisruptionbudgets/cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">uid</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 6bc1bf12</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">2fa2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">11e9</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">aea5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">009c0296e48e</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">maxUnavailable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">selector</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">matchLabels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">app</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandracluster</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cassandracluster</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">cluster</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> k8s.pic</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">currentHealthy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">13</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">desiredHealthy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">13</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">disruptedPods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token null important">null</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">disruptionsAllowed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">expectedPods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">14</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">observedGeneration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span></div></code></pre></div><p>In this example we see that we allowed only 1 Pod unavailable, and on our cluster we wants to have 14 pods and we only
have 13 healthy, that&#x27;s why the PDB won&#x27;t allow the eviction of an additional pod.</p><p>To be able to continue, we need to wait or to make appropriate actions so that the Cassandra cluster won&#x27;t have any
unavailable nodes.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="k8s-host-major-failure-replacing-a-cassandra-node"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#k8s-host-major-failure-replacing-a-cassandra-node" title="Direct link to heading">#</a>K8S host major failure: replacing a cassandra node</h3><p>In the case of a major host failure, it may not be possible to bring back the node to life. We can in this case
consider that our cassandra node is lost and we will want to replace it on another host.</p><p>In this case we may have 2 solutions that will require some manual actions :</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="remove-old-node-and-create-new-one"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#remove-old-node-and-create-new-one" title="Direct link to heading">#</a>Remove old node and create new one</h4><ol><li>In this case we will use CassKop client to schedule a cassandra removenode for the failing node.</li></ol><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl casskop remove --pod &lt;pod_name&gt; [--previous-ip &lt;previous_ip_pod&gt;] {--from-pod &lt;pod_name&gt; | --crd &lt;crd_name&gt;}</span></div></code></pre></div><p>This will trigger the PodOperation removenode by setting the appropriate labels on a cassandra Pod.</p><ol start="2"><li>Once the node is properly removed, we can free the link between the Pod and the failing host by removing the
associated PodDisruptionBudget</li></ol><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl delete pvc data-cassandra-test-dc1-rack2-1</span></div></code></pre></div><p>This will allow Kubernetes to reschedule the Pod on another free host.</p><ol start="3"><li>Once the node is back in the cluster we need to apply a cleanup on all nodes </li></ol><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl casskop cleanup start</span></div></code></pre></div><p>you can pause the cleanup and check status with </p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl casskop cleanup pause</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl casskop cleanup status</span></div></code></pre></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="replace-node-with-a-new-one"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#replace-node-with-a-new-one" title="Direct link to heading">#</a>Replace node with a new one</h4><p>In some cases It may be useful to prefer to replace the node. Because we use a statefulset to deploy cassandra pods,
by definition all pods are identical and we couldn&#x27;t execute specific actions on a specific node at startup.</p><p>For that CassKop provide the ability to execute a <code>pre_run.sh</code> script that can be change using the CRD ConfigMap.</p><p>To see how to use the configmap see <a href="/casskop/docs/3_tasks/2_configuration_deployment/2_cassandra_configuration#configuration-override-using-configmap">Overriding Configuration using configMap</a></p><p>for example If we want to replace the node cassandra-test-dc1-rack2-1, we first need to retrieve it&#x27;s IP address from
nodetool status for example :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ nodetool status</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Datacenter: dc1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">===============</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Status=Up/Down</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|/ State=Normal/Leaving/Joining/Moving</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--  Address         Load       Tokens       Owns (effective)  Host ID                               Rack</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.31.184.189  35.18 GiB  256          51.2%             9455a9bd-7a61-405e-8c3f-ee1f72f63500  rack1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.31.180.138  37 GiB     256          51.0%             1ad1b4b7-c719-4683-8109-31aa9722c1ee  rack2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.31.179.248  37.86 GiB  256          47.4%             69cbf178-2477-4420-ac71-6fad10f93759  rack2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.31.182.120  41.76 GiB  256          50.2%             a4ffac86-990d-4487-80a0-b2e177d8e06e  rack1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DN  172.31.183.213  31.14 GiB  256          51.9%             e45107ba-fe7b-4904-98cf-1373d1946bb5  rack2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">UN  172.31.181.193  33.15 GiB  256          48.4%             35806f73-17fb-4d91-b2e7-8333f393189b  rack1</span></div></code></pre></div><p>Then we can edit the ConfigMap to edit the pre_run.sh script :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-yaml codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> v1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ConfigMap</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">configmap</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">pre</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">run</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">pre_run.sh</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">|</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    echo &quot;** this is a pre</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">scrip for run.sh that can be edit with configmap&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    test &quot;$(hostname)&quot; == &#x27;cassandra</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">dc1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">rack3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">0&#x27; &amp;&amp; echo &quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">Dcassandra.replace_address_first_boot=172.31.183.213&quot; </span><span class="token punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"> /etc/cassandra/jvm.options</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    echo &quot;** end of pre_run.sh script</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> continue with run.sh&quot;</span></div></code></pre></div><p>So the Operation will be :
1. Edit the configmap with the appropriate CASSANDRA_REPLACE_NODE IP for the targeted pod name
2. delete the pvc data-cassandra-test-dc1-rack2-1
3. the Pod will boot, execute the pre_run.sh script prior to the /run.sh
4. the new pod replace the dead one by re-syncing the content which could take some times depending on the data size.
5. Do not forget to edit again the ConfigMap and to remove the specific line with replace_node instructions.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/Orange-OpenSource//casskop/edit/master/website/docs/5_operations/1_cluster_operations.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/casskop/docs/3_tasks/2_configuration_deployment/11_cassandra_cluster_status"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« CassandraCluster Status</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/casskop/docs/5_operations/2_pods_operations"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">Pods Operations »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#initializing" class="contents__link">Initializing</a></li><li><a href="#updateconfigmap" class="contents__link">UpdateConfigMap</a></li><li><a href="#updatedockerimage" class="contents__link">UpdateDockerImage</a></li><li><a href="#updateresources" class="contents__link">UpdateResources</a></li><li><a href="#scaling-the-cluster" class="contents__link">Scaling the cluster</a></li><li><a href="#updatescaledown" class="contents__link">UpdateScaleDown</a></li><li><a href="#updateseedlist" class="contents__link">UpdateSeedList</a></li><li><a href="#correctcrdconfig" class="contents__link">CorrectCRDConfig</a></li><li><a href="#delete-a-dc" class="contents__link">Delete a DC</a></li><li><a href="#kubernetes-node-maintenance-operation" class="contents__link">Kubernetes node maintenance operation</a></li><li><a href="#k8s-host-major-failure-replacing-a-cassandra-node" class="contents__link">K8S host major failure: replacing a cassandra node</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Getting Started</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/casskop/docs/1_concepts/1_introduction">Documentation</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/Orange-OpenSource/casskop">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://casskop.slack.com">Slack</a></li><li class="footer__item"><a class="footer__link-item" href="/casskop/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://twitter.com">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Contact</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="mailto:prj.casskop.support@list.orangeportails.net">Email</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/Orange-OpenSource/casskop/issues">Feature request</a></li></ul></div></div><div class="text--center">Copyright © 2020 Orange, Inc. Built with Docusaurus.</div></div></footer>
</div>

<script src="/casskop/styles.96fb9c2f.js"></script>

<script src="/casskop/runtime~main.af3b06b0.js"></script>

<script src="/casskop/main.048f9187.js"></script>

<script src="/casskop/1.6b5a90ca.js"></script>

<script src="/casskop/2.e9ab7e35.js"></script>

<script src="/casskop/3.0262e3d0.js"></script>

<script src="/casskop/1be78505.def29596.js"></script>

<script src="/casskop/3cde0363.a92a210d.js"></script>

<script src="/casskop/17896441.59c2e6d3.js"></script>

<script src="/casskop/d4be8f67.a27127cc.js"></script>


</body>
</html>