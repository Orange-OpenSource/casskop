<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">


<title data-react-helmet="true">Advanced Configuration | Casskop</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="Casskop"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="## Docker login for private registry"><meta data-react-helmet="true" property="og:description" content="## Docker login for private registry"><meta data-react-helmet="true" property="og:url" content="https://orange-opensource.github.io/casskop/docs/3_tasks/2_configuration_deployment/9_advanced_configuration">

<link data-react-helmet="true" rel="shortcut icon" href="/casskop/img/casskop.ico">


<link rel="stylesheet" href="/casskop/styles.fd86d1d7.css">


<link rel="preload" href="/casskop/styles.96fb9c2f.js" as="script">

<link rel="preload" href="/casskop/runtime~main.145284b4.js" as="script">

<link rel="preload" href="/casskop/main.048f9187.js" as="script">

<link rel="preload" href="/casskop/1.6b5a90ca.js" as="script">

<link rel="preload" href="/casskop/2.e9ab7e35.js" as="script">

<link rel="preload" href="/casskop/3.0262e3d0.js" as="script">

<link rel="preload" href="/casskop/1be78505.def29596.js" as="script">

<link rel="preload" href="/casskop/3cde0363.a92a210d.js" as="script">

<link rel="preload" href="/casskop/17896441.59c2e6d3.js" as="script">

<link rel="preload" href="/casskop/e9998e2b.a702af72.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}function e(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}var n=window.matchMedia("(prefers-color-scheme: dark)");n.addListener((function(n){null===e()&&t(n.matches?"dark":"")}));var a=e();null!==a?t(a):n.matches&&t("dark")}()</script>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}function e(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}var n=window.matchMedia("(prefers-color-scheme: dark)");n.addListener((function(n){null===e()&&t(n.matches?"dark":"")}));var a=e();null!==a?t(a):n.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/casskop/"><img class="navbar__logo" src="/casskop/img/casskop_alone.png" alt="Casskop Logo"><strong>Casskop</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/casskop/docs/1_concepts/1_introduction">Docs</a><a class="navbar__item navbar__link" href="/casskop/blog">Blog</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/Orange-OpenSource/casskop">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/casskop/"><img class="navbar__logo" src="/casskop/img/casskop_alone.png" alt="Casskop Logo"><strong>Casskop</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/1_concepts/1_introduction">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://github.com/Orange-OpenSource/casskop">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="sidebarLogo_3ono"><img src="/casskop/img/casskop_alone.png" alt="Casskop Logo"><strong>Casskop</strong></div><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/1_concepts/1_introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/1_concepts/2_design_principes">Design Principes</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/1_concepts/3_features">Features</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/1_concepts/4_roadmap">Roadmap</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Setup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/2_setup/1_getting_started">Getting Started</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Platform Setup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/2_setup/2_platform_setup/1_gke">Google Kubernetes Engine</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/2_setup/2_platform_setup/2_minikube">MiniKube</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Install</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/2_setup/3_install/1_customizable_install_with_helm">Customizable install with Helm</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/2_setup/3_install/2_install_plugin">Install Plugin</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Tasks</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/1_operator_description">Operator Description</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Configuration Deployment</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/1_cassandra_cluster">Cassandra Cluster</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/2_cassandra_configuration">Cassandra Configuration</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/3_storage">Storage</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/4_sidecars">Sidecars</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/5_kubernets_objects">Kubernetes Objects</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/6_cpu_memory_usage">CPU and Memory Usage</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/7_cluster_topology">Cluster topology</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/8_implementation_architecture">Implementation architecture</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/casskop/docs/3_tasks/2_configuration_deployment/9_advanced_configuration">Advanced Configuration</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/10_nodes_management">Nodes Management</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/3_tasks/2_configuration_deployment/11_cassandra_cluster_status">CassandraCluster Status</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Operations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/5_operations/1_cluster_operations">Cluster Operations</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/5_operations/2_pods_operations">Pods Operations</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Upgrade</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/5_operations/3_upgrading/1_upgrade_operator">Upgrade Operator</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/5_operations/3_upgrading/2_upgrade_bootstrap_image">Upgrade Bootstrap Image</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Uninstall</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/5_operations/4_uninstall/1_casskop">Casskop</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">MultiCasskop</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/5_operations/5_multicasskop/1_cassandra_cluster">Cassandra Cluster</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Cassandra Cluster</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/6_references/1_cassandra_cluster/1_cassandra_cluster">Cassandra cluster</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/6_references/1_cassandra_cluster/2_topology">Topology</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/6_references/1_cassandra_cluster/3_cassandra_cluster_status">Cassandra cluster Status</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">MultiCasskop</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/6_references/2_multicasskop/1_multicasskop">MultiCasskop</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/7_troubleshooting/1_operations_issues">Operations Issues</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/7_troubleshooting/2_gke_issues">GKE Issues</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Contributing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/8_contributing/1_developer_guide">Developer guide</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/8_contributing/2_release_guide">Release guide</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/8_contributing/3_reporting_bugs">Reporting bugs</a></li><li class="menu__list-item"><a class="menu__link" href="/casskop/docs/8_contributing/4_credits">Credits</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Advanced Configuration</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="docker-login-for-private-registry"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#docker-login-for-private-registry" title="Direct link to heading">#</a>Docker login for private registry</h2><p>If you need to use a docker registry with authentication, then you will need to create a specific kubernetes secret with
this information.
Then you will configure the CRD with the secret name, so that it provides the data to each Statefulset, which in
turn propagate it to each created Pod.</p><p>Create the secret :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl create secret docker-registry yoursecretname \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --docker-server=yourdockerregistry</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --docker-username=yourlogin \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --docker-password=yourpass \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --docker-email=yourloginemail</span></div></code></pre></div><p>Then we will add a <strong>imagePullSecrets</strong> parameter in the CRD definition with value the name of the
previously created secret. You can give several secrets :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">imagePullSecrets:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  name: yoursecretname</span></div></code></pre></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="management-of-allowed-cassandra-nodes-disruption"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#management-of-allowed-cassandra-nodes-disruption" title="Direct link to heading">#</a>Management of allowed Cassandra nodes disruption</h2><p>CassKop makes use of the kubernetes PodDisruptionBudget objetc to specify how many cassandra nodes disruption is
allowed on the cluster. By default, we only tolerate 1 disrupted pod at a time and will prevent to makes actions if
there is aloready an ongling disruption on the cluster.</p><p>In some edge cases it can be useful to make force the operator to continue it&#x27;s actions even if there is already a
disruption ongoing. We can tune this by updating the <code>spec.maxPodUnavailable</code> parameter of the cassandracluster CRD.</p><div class="admonition admonition-important"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></div>important</h5></div><div class="admonition-content"><p>it is recommended to not touch this parameter unless you know what you are doing.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="cross-ip-management"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#cross-ip-management" title="Direct link to heading">#</a>Cross Ip Management</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="global-mecanism"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#global-mecanism" title="Direct link to heading">#</a>Global mecanism</h3><p>Cassandra works on IPs and not on hostname, so in a case where two cassandra cross their Ips, no Cassandra will be able to run properly and will loop on the following error :</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-log codeBlock_2GNs"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button><code class="codeBlockLines__q0i" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra Exception (java.lang.RuntimeException) encountered during startup: A node with address /10.100.150.35 already exists, cancelling join. Use cassandra.replace_address if you want to replace this node.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra java.lang.RuntimeException: A node with address /10.100.150.35 already exists, cancelling join. Use cassandra.replace_address if you want to replace this node.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra     at org.apache.cassandra.service.StorageService.checkForEndpointCollision(StorageService.java:577)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra     at org.apache.cassandra.service.StorageService.prepareToJoin(StorageService.java:823)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra     at org.apache.cassandra.service.StorageService.initServer(StorageService.java:683)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra     at org.apache.cassandra.service.StorageService.initServer(StorageService.java:632)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra     at org.apache.cassandra.service.CassandraDaemon.setup(CassandraDaemon.java:388)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra     at org.apache.cassandra.service.CassandraDaemon.activate(CassandraDaemon.java:620)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra     at org.apache.cassandra.service.CassandraDaemon.main(CassandraDaemon.java:732)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra ERROR [main] 2020-02-21 08:29:44,398 CassandraDaemon.java:749 - Exception encountered during startup</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra java.lang.RuntimeException: A node with address /10.100.150.35 already exists, cancelling join. Use cassandra.replace_address if you want to replace this node.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra     at org.apache.cassandra.service.StorageService.checkForEndpointCollision(StorageService.java:577) ~[apache-cassandra-3.11.4.jar:3.11.4]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra     at org.apache.cassandra.service.StorageService.prepareToJoin(StorageService.java:823) ~[apache-cassandra-3.11.4.jar:3.11.4]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra     at org.apache.cassandra.service.StorageService.initServer(StorageService.java:683) ~[apache-cassandra-3.11.4.jar:3.11.4]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra     at org.apache.cassandra.service.StorageService.initServer(StorageService.java:632) ~[apache-cassandra-3.11.4.jar:3.11.4]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra     at org.apache.cassandra.service.CassandraDaemon.setup(CassandraDaemon.java:388) [apache-cassandra-3.11.4.jar:3.11.4]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra     at org.apache.cassandra.service.CassandraDaemon.activate(CassandraDaemon.java:620) [apache-cassandra-3.11.4.jar:3.11.4]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cassandra     at org.apache.cassandra.service.CassandraDaemon.main(CassandraDaemon.java:732) [apache-cassandra-3.11.4.jar:3.11.4]</span></div></code></pre></div><p>Following the <a href="https://github.com/Orange-OpenSource/casskop/issues/170">issue #170</a>, at least using Kubernetes and <a href="https://docs.projectcalico.org/v3.9/getting-started/kubernetes/">Project Calico</a>, we may fall into this issue,
for example using a fixed <a href="https://docs.projectcalico.org/v3.9/reference/resources/ippool">ip pool</a> size.</p><p>To manage this case we introduced the <code>restartCountBeforePodDeletion</code> CassandraCluster spec field which takes an <code>int32</code> as value.</p><div class="admonition admonition-note"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>note</h5></div><div class="admonition-content"><p>If you set it with a value lower or equals to 0, or if you omit it, no action will be performed</p></div></div><p>In setting this field, the cassandra operator will check for each <code>CassandraCluster</code> if a pod is in a restart situation (based on restart count of the cassandra container inside the pod).
In the case where the restartCount of the pod is greater than the value of <code>restartCountBeforePodDeletion</code> field and if we are in a Ip cross situation, we will delete the pod, which will be recreated by the Statefulset.
In the case of Project Calico usage, this force the pod to get another available IP, which fixes our bug. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="ip-cross-situation-detection"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#ip-cross-situation-detection" title="Direct link to heading">#</a>Ip Cross situation detection</h2><p>To detect that we are in a Ip cross situation, we add a new status field <code>CassandraNodeStatus</code> which will maintain a cache about the map of <em>Ip node</em> and his <em>hostId</em>,
for all ready pods.</p><div class="admonition admonition-note"><div class="admonition-heading"><h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></div>note</h5></div><div class="admonition-content"><p>to have more information about this status field, you can check <a href="#cassandracluster-status">CassandraCluster Status</a></p></div></div><p>So when we check pods, we perform a Jolokia call to get a map of the cluster nodes IPs with their corresponding HostId.
If a pod is failing with the constraints described above, we compare the hostId associated to the Pod&#x27;s IP, and the hostId
associated to the Pod name stored into the <code>CassandraNodeStatus</code> : </p><ul><li>if they match, or there are no match for the pod Ip into the map returned by Jolokia, we are not in a Ip cross situation,</li><li>if they mismatch, we are in a Ip cross situation.</li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/Orange-OpenSource//casskop/edit/master/website/docs/3_tasks/2_configuration_deployment/9_advanced_configuration.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/casskop/docs/3_tasks/2_configuration_deployment/8_implementation_architecture"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« Implementation architecture</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/casskop/docs/3_tasks/2_configuration_deployment/10_nodes_management"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">Nodes Management »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#docker-login-for-private-registry" class="contents__link">Docker login for private registry</a></li><li><a href="#management-of-allowed-cassandra-nodes-disruption" class="contents__link">Management of allowed Cassandra nodes disruption</a></li><li><a href="#cross-ip-management" class="contents__link">Cross Ip Management</a><ul><li><a href="#global-mecanism" class="contents__link">Global mecanism</a></li></ul></li><li><a href="#ip-cross-situation-detection" class="contents__link">Ip Cross situation detection</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Getting Started</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/casskop/docs/1_concepts/1_introduction">Documentation</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/Orange-OpenSource/casskop">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://casskop.slack.com">Slack</a></li><li class="footer__item"><a class="footer__link-item" href="/casskop/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://twitter.com">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Contact</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="mailto:prj.casskop.support@list.orangeportails.net">Email</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/Orange-OpenSource/casskop/issues">Feature request</a></li></ul></div></div><div class="text--center">Copyright © 2020 Orange, Inc. Built with Docusaurus.</div></div></footer>
</div>

<script src="/casskop/styles.96fb9c2f.js"></script>

<script src="/casskop/runtime~main.145284b4.js"></script>

<script src="/casskop/main.048f9187.js"></script>

<script src="/casskop/1.6b5a90ca.js"></script>

<script src="/casskop/2.e9ab7e35.js"></script>

<script src="/casskop/3.0262e3d0.js"></script>

<script src="/casskop/1be78505.def29596.js"></script>

<script src="/casskop/3cde0363.a92a210d.js"></script>

<script src="/casskop/17896441.59c2e6d3.js"></script>

<script src="/casskop/e9998e2b.a702af72.js"></script>


</body>
</html>